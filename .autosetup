#!/bin/bash -eu

#===============================================================================
# Automated home directory setup script
# -------------------------------------
#
# To automate the setup of your home directory you can run this script via:
#
#   curl http://sensus-stash.davis.sensus.lab:7990/users/carej/repos/homedir/browse/.autosetup?raw | bash
#
# Yes, the "curl pipe" method is scary to some. If it's scary to you then just
# download the file first then execute it locally.
#===============================================================================

[[ -d ${HOME}/sandbox ]] || mkdir ${HOME}/sandbox

# note the subshell here since we are changing directories!
#
[[ -d ${HOME}/sandbox/homedir ]] || (

  cd ${HOME}/sandbox
  git clone --no-checkout http://carej@sensus-stash.davis.sensus.lab:7990/scm/~carej/homedir.git
  cd homedir
  git config core.worktree ${HOME}
)

[[ -f ${HOME}/.git ]] || {

  echo "gitdir: ${HOME}/sandbox/homedir/.git" > ${HOME}/.git
}

git reset --hard origin/master
